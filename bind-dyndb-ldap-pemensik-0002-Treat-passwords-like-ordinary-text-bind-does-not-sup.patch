From ba828bdd09a8203ff6c8e3a2bc66f6af75e3330a Mon Sep 17 00:00:00 2001
From: rpm-build <rpm-build>
Date: Mon, 20 Feb 2017 14:19:41 +0100
Subject: [PATCH 2/3] Treat passwords like ordinary text, bind 9.9 does not
 support change 3701. Uses simple cfg_print.

---
 src/ldap_helper.c | 2 +-
 src/settings.c    | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/ldap_helper.c b/src/ldap_helper.c
index 94bd9cf..fb7c67f 100644
--- a/src/ldap_helper.c
+++ b/src/ldap_helper.c
@@ -246,7 +246,7 @@ dyndb_ldap_conf_clauses[] = {
 	{ "krb5_keytab",        &cfg_type_qstring,	0	},
 	{ "krb5_principal",     &cfg_type_qstring,	0	},
 	{ "ldap_hostname",      &cfg_type_qstring,	0	},
-	{ "password",           &cfg_type_sstring,	0	},
+	{ "password",           &cfg_type_qstring,	0	},
 	{ "reconnect_interval", &cfg_type_uint32,	0	},
 	{ "sasl_auth_name",     &cfg_type_qstring,	0	},
 	{ "sasl_mech",          &cfg_type_qstring,	0	},
diff --git a/src/settings.c b/src/settings.c
index 37e6e5c..8f3ae34 100644
--- a/src/settings.c
+++ b/src/settings.c
@@ -605,7 +605,7 @@ settings_set_fill(const cfg_obj_t *config, settings_set_t *set)
 			/* this avoids additional quotes around the string */
 			str_value = cfg_obj_asstring(cfg_value);
 		} else {
-			cfg_printx(cfg_value, 0, cfg_printer, buf_value);
+			cfg_print(cfg_value, cfg_printer, buf_value);
 			isc_buffer_putmem(buf_value, (unsigned char *)"\0", 1);
 			str_value = isc_buffer_base(buf_value);
 		}
@@ -690,7 +690,7 @@ setting_set_parse_conf(isc_mem_t *mctx, const char *name,
 	result = cfg_parse_buffer2(parser, &in_buf, name, cfg_type_conf,
 				   &config);
 	if (result == ISC_R_SUCCESS) {
-		cfg_printx(config, CFG_PRINTER_XKEY, cfg_printer, log_buf);
+		cfg_print(config, cfg_printer, log_buf);
 		cfg_obj_log(config, dns_lctx, ISC_LOG_DEBUG(10),
 			    "configuration for dyndb instance '%s' "
 			    "(starting in file %s on line %lu):\n"
-- 
2.9.3

